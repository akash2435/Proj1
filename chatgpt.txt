@page "/"
@inject JSRuntime JS
@inject GoogleMapsService MapsService

<h3>Property Search</h3>
<input @bind="SearchQuery" placeholder="Enter property address" />
<button @onclick="GetMapImage">Search</button>

@if (!string.IsNullOrEmpty(MapImageUrl))
{
    <img src="@MapImageUrl" alt="Property Image" width="600" />
    <button @onclick="DownloadPdf">Download Report</button>
}

@code {
    private string SearchQuery { get; set; }
    private string MapImageUrl { get; set; }

    private void GetMapImage()
    {
        MapImageUrl = MapsService.GetStaticMapUrl(SearchQuery);
    }

    private async Task DownloadPdf()
    {
        var url = $"/api/report?address={Uri.EscapeDataString(SearchQuery)}";
        await JS.InvokeVoidAsync("open", url, "_blank");
    }
}
